{% extends 'accounts/admin_base.html' %}
{% block title %}{{ status_label }} Cases{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
  <!-- Header -->
  <div class="mb-6">
    <a href="{% url 'dashboard' %}" class="inline-flex items-center text-purple-600 hover:text-purple-700 font-semibold mb-4">
      <i class="fas fa-arrow-left mr-2"></i>Back to Dashboard
    </a>
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-3xl font-bold text-gray-800 flex items-center">
          <i class="fas fa-list-alt text-purple-600 mr-3"></i>
          {{ status_label }} Cases
        </h1>
        <p class="text-gray-600 mt-1">Total: {{ total_count }} case{{ total_count|pluralize }}</p>
      </div>
    </div>
  </div>

  <!-- Cases Table -->
  <div class="stat-card">
    <div class="overflow-x-auto">
      <table class="min-w-full">
        <thead>
          <tr class="border-b-2 border-purple-200 bg-purple-50">
            <th class="text-left p-4 font-bold text-gray-700">Case Number</th>
            <th class="text-left p-4 font-bold text-gray-700">Applicant</th>
            <th class="text-left p-4 font-bold text-gray-700">Bank</th>
            <th class="text-left p-4 font-bold text-gray-700">Advocate</th>
            <th class="text-left p-4 font-bold text-gray-700">LRN</th>
            <th class="text-center p-4 font-bold text-gray-700">Updated</th>
            <th class="text-center p-4 font-bold text-gray-700">Action</th>
          </tr>
        </thead>
        <tbody>
          {% for case in cases %}
          <tr class="border-b border-gray-100 hover:bg-purple-50 transition-colors">
            <td class="p-4">
              <div class="font-semibold text-gray-800">{{ case.case_number }}</div>
              {% if case.child_cases.exists %}
              <div class="text-xs text-blue-600">
                <i class="fas fa-layer-group mr-1"></i>{{ case.child_cases.count }} linked
              </div>
              {% endif %}
            </td>
            <td class="p-4">
              <div class="text-gray-800">{{ case.applicant_name }}</div>
            </td>
            <td class="p-4">
              <div class="text-gray-800">{{ case.bank.name }}</div>
              {% if case.branch %}<div class="text-xs text-gray-500">{{ case.branch.name }}</div>{% endif %}
            </td>
            <td class="p-4">
              {% if case.assigned_advocate %}
              <div class="text-gray-800">{{ case.assigned_advocate.name }}</div>
              <div class="text-xs text-gray-500">{{ case.assigned_advocate.employee_id }}</div>
              {% else %}
              <span class="text-gray-400 italic">Unassigned</span>
              {% endif %}
            </td>
            <td class="p-4">
              {% if case.legal_reference_number %}
              <code class="text-xs bg-gray-100 px-2 py-1 rounded">{{ case.legal_reference_number }}</code>
              {% else %}
              <span class="text-gray-400 text-xs">--</span>
              {% endif %}
            </td>
            <td class="p-4 text-center text-sm text-gray-600">
              {{ case.updated_at|date:"M d, Y" }}
            </td>
            <td class="p-4 text-center">
              <a href="{% url 'case_detail' case.id %}" class="inline-flex items-center px-3 py-1 rounded-lg bg-purple-600 hover:bg-purple-700 text-white text-xs font-semibold transition-colors">
                <i class="fas fa-eye mr-1"></i>View
              </a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td class="p-12 text-center text-gray-400" colspan="7">
              <i class="fas fa-inbox text-6xl mb-4 opacity-30"></i>
              <div class="text-lg">No cases found</div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
